name: 'Setup Environment'
description: 'Setup build environment with .NET 9 SDK and MSBuild'
inputs:
  dotnet-version:
    description: '.NET SDK version to use'
    required: false
    default: '9.0.x'
  msbuild-architecture:
    description: 'MSBuild architecture'
    required: false
    default: 'x64'

runs:
  using: 'composite'
  steps:
    - name: Setup .NET SDK
      uses: actions/setup-dotnet@v4
      with:
        dotnet-version: ${{ inputs.dotnet-version }}

    - name: Setup MSBuild
      uses: microsoft/setup-msbuild@v2
      with:
        msbuild-architecture: ${{ inputs.msbuild-architecture }}


    - name: Setup NuGet
      uses: NuGet/setup-nuget@v2

    - name: Clear NuGet cache
      shell: pwsh
      run: |
        Write-Host "=== Clearing NuGet cache ===" -ForegroundColor Yellow
        dotnet nuget locals all --clear
        Write-Host "âœ… NuGet cache cleared" -ForegroundColor Green

    - name: Display environment info
      shell: pwsh
      run: |
        Write-Host "=== Environment Information ===" -ForegroundColor Cyan
        Write-Host "OS: $env:OS"
        Write-Host "Runner OS: $env:RUNNER_OS"
        Write-Host ""

        Write-Host "=== .NET SDK Information ===" -ForegroundColor Green
        dotnet --list-sdks
        dotnet --version
        Write-Host ""

        Write-Host "=== MSBuild Information ===" -ForegroundColor Green
        msbuild -version
        Write-Host ""

        Write-Host "=== NuGet Information ===" -ForegroundColor Green
        nuget help | Select-Object -First 1
